<!DOCTYPE html>
<html><head>
  <title>Using Syncthing</title>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../../css/theme.css"/>
  <link rel="stylesheet" href="../../../css/syntax.css"/>

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-56296045-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  <meta property="og:title" content="Using Syncthing" />
<meta property="og:description" content="Syncthing is a way to keep things up-to-date across machines without going through any 3rd party servers. You get both backup and file synchronization without pesky servers just using the computer capacity you probably already have laying around. Lets give it a spin. Installation on Debian   On the Getting Started page of syncthing they recommend using a GUI package, but we&#39;re going to install on debian on the command line." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://willschenk.com/articles/2020/using_syncthing/" />
<meta property="article:published_time" content="2020-06-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-06-17T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using Syncthing"/>
<meta name="twitter:description" content="Syncthing is a way to keep things up-to-date across machines without going through any 3rd party servers. You get both backup and file synchronization without pesky servers just using the computer capacity you probably already have laying around. Lets give it a spin. Installation on Debian   On the Getting Started page of syncthing they recommend using a GUI package, but we&#39;re going to install on debian on the command line."/>
<meta name="twitter:site" content="@wschenk"/>


  <style>
    .article p, .article ul, .article ol, .article table {
      max-width: 45em;
    }

    .article pre p {
    max-width: none;
    margin-top: -1.5rem;
    }

    article.article p:first-child, .article blockquote {
      font-size: 1.25em;
      font-weight: 300;
      max-width: 36em;  
    }
  </style>
</head>
<body><nav class="container my-5">
  <h1 class="pt-md-5 display-3"><a class="text-dark" href="../../../">Will Schenk</a></h1>
  <p>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../articles/" title="">Articles</a>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../contact" title="">Contact</a>
    
      <a class="text-dark h4 mr-3 font-weight-light" href="../../../tags/" title="">Tags</a>
    
    <a href="../../../feed.xml" class="mr-3 h4 text-light"><img src="../../../img/rss.svg" alt="rss" height="20" width="20"/></a>
    
      <a href="https://twitter.com/@wschenk" class="mr-3 h4 text-light"><img src="../../../img/twitter.svg" alt="twitter" height="20" width="20"/></a>
    
    
      <a href="https://instagram.com/wschenk" class="mr-3 h4 text-light"><img src="../../../img/instagram.svg" alt="instagram" height="20" width="20"/></a>
    
    
      <a href="https://github.com/wschenk" class="mr-3 h4 text-light"><img src="../../../img/github.svg" alt="github" height="20" width="20"/></a>
    
    
      <a href="https://linkedin.com/in/will-schenk-420266" class="mr-3 h4 text-light"><img src="../../../img/linkedin.svg" alt="linkedin" height="20" width="20"/></a>
    
  </p>
</nav>

<div class="container">
  <h1 class="mt-5">Using Syncthing</h1>

  
    <h2 class="font-weight-light font-italic mb-3">who needs servers</h2>
  

  <p class="text-muted mt-3">
    <a class="text-muted" href="https://willschenk.com/articles/2020/using_syncthing/">Published June 17, 2020</a>

    
      <a class="text-muted" href="../../../tags/howto">#howto,</a>
    
      <a class="text-muted" href="../../../tags/p2p">#p2p</a>
    
  </p>

  

  

  <article class="article mt-5">
    
<p>
Syncthing is a way to keep things up-to-date across machines without going through any 3rd party servers.  You get both backup and file synchronization without pesky servers just using the computer capacity you probably already have laying around.  Lets give it a spin.
</p>
<h2 id="headline-1">
Installation on Debian
</h2>
<p>
On the <a href="https://docs.syncthing.net/intro/getting-started.html">Getting Started</a> page of syncthing they recommend using a GUI package, but we&#39;re going to install on debian on the command line.
</p>
<div class="src src-bash">
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># Add the release PGP keys:</span>
curl -s https://syncthing.net/release-key.txt <span class="p">|</span> sudo apt-key add -

<span class="c1"># Add the &#34;stable&#34; channel to your APT sources:</span>
<span class="nb">echo</span> <span class="s2">&#34;deb https://apt.syncthing.net/ syncthing stable&#34;</span> <span class="p">|</span> sudo tee /etc/apt/sources.list.d/syncthing.list

<span class="c1"># Update and install syncthing:</span>
sudo apt-get update
sudo apt-get install syncthing</code></pre></div>
</div>
<p>
This installs both the syncthing binary as well as the systemd configuration file.
</p>
<h2 id="headline-2">
Initial Setup
</h2>
<p>
Now we can start it up pretty easily.
</p>
<div class="src src-bash">
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">systemctl <span class="nb">enable</span> syncthing@<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>.service
systemctl start syncthing@<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>.service</code></pre></div>
</div>
<p>
Since I&#39;m running in a container, I needed to change the GUI listen address.  Edit <code class="verbatim">~/.config/syncthing/config.xml</code> and change the <code class="verbatim">&lt;gui&gt;&lt;address&gt;</code> entry to be 0.0.0.0:8384 instead of 127.0.0.1, and then restart.
</p>
<div class="src src-bash">
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">systemctl restart syncthing@<span class="si">${</span><span class="nv">USER</span><span class="si">}</span>.service</code></pre></div>
</div>
<p>
Now go to <a href="http://localhost:8384/">locahost:8384</a> and you should be see the WebUI. It should also give you a warning and opportunity to set a username and password, so go ahead and set one up.  Also might as well use HTTPS because why not.
</p>
<p>









<img class='' style='width: 100%' src='../../../articles/2020/using_syncthing/username.png'>

</p>
<p>
This technique would also work if you installed it remotely.
</p>
<h2 id="headline-3">
Adding your phone
</h2>
<p>
If you are using Android, lets install the <a href="https://play.google.com/store/apps/details?id=com.nutomic.syncthingandroid&amp;hl=en_US">Syncthing Android App from the Play Store</a>.  I&#39;m not sure if there&#39;s an iOS build, but I doubt it would be super useful anyway since Apple locks things down into their own ecosystem that&#39;s doesn&#39;t play very nicely with others.  You might be able to use it for storage though.
</p>
<p>
Once installed it will prompt you for permissions.  Grant it
</p>
<p>









<img class='' style='max-width:100%' src='../../../articles/2020/using_syncthing/permission_hu586a1942deab2c748d2db87007bdaa40_125743_500x500_fit_box_2.png'>

</p>
<p>
Now lets add the two machines together.  On your computer, go to &#34;Actions -&gt; Show Device ID&#34;
</p>
<p>
On the phone, go to the devices tab, and then press the + on the top right, and scan in the QR code from the computer.  Give it a name, and also turn on &#34;Introducer&#34; which will make it easier to further add nodes into your network.
</p>
<p>
Give the system a few minutes to talk with each other, and eventually you&#39;ll see a window that will ask if you want to pair.
</p>
<p>









<img class='' style='width: 100%' src='../../../articles/2020/using_syncthing/pair.png'>

</p>
<p>
Note that these Device IDs are OK to share since you need you need to setup a two way connection between the devices to actually do anything.  Discovery and relay servers for example know about device IDs, so they aren&#39;t the private ones that you really need to keep secure.  I&#39;m not an expert on this but this is what I understand.
</p>
<p>









<img class='' style='width: 100%' src='../../../articles/2020/using_syncthing/adddevice.png'>

</p>
<h2 id="headline-4">
Syncing downloads
</h2>
<p>
One handy use case is to sync all mobile downloads to your laptop.  If you&#39;ve ever clicked on a PDF and tried to read it on the phone and gone through that pain, it&#39;s nice to be able to have that stuff on your laptop with a bigger monitor.  This makes it easy to clean out the downloads on your phone if you end up with too much junk there – simply move it out of the folder on you laptop and syncthing will remove it from the phone.  Lets add that now.
</p>
<p>
Go the <code class="verbatim">Folders</code> tab and press the + button on the top right.  Name it something like &#34;Mobile Downloads&#34;, and then select the Downloads folder.  It will prompt for permission like so:
</p>
<p>









<img class='' style='max-width:100%' src='../../../articles/2020/using_syncthing/grantpermission_hu435537700adb1953a693a9c9a0f06386_216219_500x500_fit_box_2.png'>

</p>
<p>
And you&#39;ll end up with something like
</p>
<p>









<img class='' style='max-width:100%' src='../../../articles/2020/using_syncthing/sharefolder_hub90f36bc94fffe399165141c8ce1a52d_206148_500x500_fit_box_2.png'>

</p>
<p>
Once you press the check, it will start syncing to your laptop.  If you&#39;ve selected AutoAccept it will immediately start syncing, otherwise you will get a prompt on the web interface to see if that&#39;s really what you want to do.
</p>
<p>









<img class='' style='width: 100%' src='../../../articles/2020/using_syncthing/acceptprompt.png'>

</p>
<p>
It&#39;s useful to accept manually rather than automatically since that will give you an opportunity to decide where you want the directory named.  If you choose automate it will be the cloud name not human readable, and I&#39;m not sure how to change it after.
</p>
<h2 id="headline-5">
Ignore patterns
</h2>
<p>
I&#39;m an <a href="https://orgmode.org/">org-mode</a> convert and I wanted a way to sync up my <code class="verbatim">~/org</code> directory to the phone.  Lets do that.
</p>
<p>
On the computer, go to the WebUI and select Add Folder.  On first screen give it a name, and the right path.  Select the phone device that you want to use and go to the <code class="verbatim">Ignore Patterns</code> pane.  Since this is emacs, we don&#39;t need to sync any of the temporary files over.
</p>
<p>









<img class='' style='width: 100%' src='../../../articles/2020/using_syncthing/ignorepattern.png'>

</p>
<p>
Now that we&#39;ve added it, we need to go to the phone an accept.  Go back to the syncthings app on the phone, and in the hamburger menu select &#34;Show WebUI&#34;.  You&#39;ll get this dialog:
</p>
<p>









<img class='' style='max-width:100%' src='../../../articles/2020/using_syncthing/appaccept_hud6262d63e019071ade5df591a70740d7_196580_500x500_fit_box_2.png'>

</p>
<p>
Add and there you go.
</p>
<h2 id="headline-6">
Ignore permissions
</h2>
<p>
I also sync my <code class="verbatim">.emacs.d</code> folder to the phone, mainly for backup purposes.  One thing is to be aware of is that you don&#39;t want to sync permissions, since Android loses those and the reverse sync will potentially reset what you have.
</p>
<h2 id="headline-7">
Using <a href="http://www.orgzly.com/">Orgzly</a>
</h2>
<p>
<a href="http://www.orgzly.com/">Orgzly</a> is an Android app that knows about .org files.  Now that we&#39;ve set the sync of our <code class="verbatim">org</code> directory on the mobile phone&#39;s local directory, setting a local sync in a breeze to pull in whatever files you need to see.  I mean, not much to say here really you&#39;ve already got the folder.
</p>
<h2 id="headline-8">
Final setup
</h2>
<p>
<code class="verbatim">.emacs.d</code> folder synced from my laptop.  Since this is a Chromebook, I don&#39;t like to have anything &#34;permanent&#34; on it, and this is a nice way to get everything back when I wipe it compared to checking things into github.  This goes to the phone purely for backup.
</p>
<p>
<code class="verbatim">Downloads</code> synced from the phone, which is mostly downloading PDFs and occasionally programming books.  Everything gets pushed to the laptop, which I then move out of that folder into an archive.
</p>
<p>
<code class="verbatim">reading</code> which is that archive, where I have long form books and other paper and articles in there.  I use <code class="verbatim">pdf-tools</code> in emacs to read and make annotations directly in the books, which is handy.
</p>
<p>
<code class="verbatim">willschenk.com</code> which is managed by <code class="verbatim">git</code> and stored in github, and published on github pages.  Here, having commits and discrete chunks of changes makes sense.  Since I only work on this on one computer at a time, it&#39;s not as important to keep it published, but if I go back to having a work computer I think adding this into syncthing makes sense.
</p>
<p>
So far I&#39;m very impressed with the level of polish that syncthing has.  It&#39;s a little cumbersome to figure out how to set it up, but once set up it just seems to work.  I have more confidence now that if my laptop blew up I&#39;d be able to get everything cleaned up faster.  I still have a bunch of legacy archival stuff on my personal Dropbox that would be too much to store on the phone without putting in a SD card – which might make sense to do.  With that my personal storage cloud would have most of what I&#39;d need.
</p>
<h2 id="headline-9">
References
</h2>
<ol>
<li>
<p>
<a href="https://docs.syncthing.net/users/autostart.html">https://docs.syncthing.net/users/autostart.html</a>
</p>
</li>
<li>
<p>
<a href="https://docs.syncthing.net/users/faq.html">https://docs.syncthing.net/users/faq.html</a>
</p>
</li>
<li>
<p>
<a href="https://docs.syncthing.net/dev/device-ids.html#device-ids">https://docs.syncthing.net/dev/device-ids.html#device-ids</a>
</p>
</li>
<li>
<p>
<a href="https://wiki.archlinux.org/index.php/Systemd/User#Automatic_start-up_of_systemd_user_instances">https://wiki.archlinux.org/index.php/Systemd/User#Automatic_start-up_of_systemd_user_instances</a>
</p>
</li>
<li>
<p>
<a href="https://medium.com/@JosephKiran/replacing-cloud-based-to-do-apps-with-orgzly-and-syncthing-6a065419d61">https://medium.com/@JosephKiran/replacing-cloud-based-to-do-apps-with-orgzly-and-syncthing-6a065419d61</a>
</p>
</li>
</ol>

  </article>

  
</div>


  <div class="bg-light py-5">
    <div class="container">
      <h2 class="text-center">Read next</h2>

      <div class="row">
        <div class="col-md-6 text-center">
          
            Next Post:
            <a href="../../../articles/2020/checking_rss_health/">Checking health of RSS feeds</a>
          
        </div>
        <div class="col-md-6 text-center">
          
            Previous Post:
            <a href="../../../articles/2020/developing_react_inside_docker/">Developing React Inside Docker</a>
          
        </div>
      </div>
    </div>
  </div>




<div class="container mt-5">
  <h2 class="text-center">See also</h2>
  <div class="row">
  	
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2020/simple_cors_workaround_for_local_development/">Simple CORS workaround for local development</a></p>

        
        <div class="font-weight-light mt-3">
          
          
            <p>I&#39;ve been doing a lot of web development old school, just editing HTML and JavaScript by hand without a build environment. Running npx live-server is an easy one liner to spin up a server, that opens a browser for you and also updates changes on safe.  Sometimes that&#39;s not enough. Often you want to pull in data from an API, and that requires HTTPS, and also you need to work around CORS limitations.</p>
          
        </div>
        <a href="../../../articles/2020/simple_cors_workaround_for_local_development/" class="btn btn-primary">Read more</a>
      </div>
    
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2019/setting_up_an_ipfs_node/">Setting up an IPFS Node</a></p>

        
          <p class="lead font-italic mb-0">using docker-compose and certbot</p>
        
        <div class="font-weight-light mt-3">
          
          
            <p>IPFS nodes that run in the broswer communicate over websockets to the main network. Lets walk through how to setup a IPFS server that your browser code can connect to in addition to the public gateways. Strategy     Wire everything up with docker-compose    Create and configure an ipfs container    Setup nginx with dummy certificate    Replace that certificate with certbot    Setup certbot to auto renew the certificates   Requirements   You will need:    A server with a domain or subdomain to use certbot to get a certificate    A working docker-compose install    I&#39;m using a prebuilt docker image on Digital Ocean but the key part is to get the domain name.</p>
          
        </div>
        <a href="../../../articles/2019/setting_up_an_ipfs_node/" class="btn btn-primary">Read more</a>
      </div>
    
      <div class="col-md mb-3">
        <p class="lead mb-0"><a class="text-body" href="../../../articles/2019/using_org_mode_in_hugo/">Using Org Mode in Hugo</a></p>

        
          <p class="lead font-italic mb-0">emacs everywhere</p>
        
        <div class="font-weight-light mt-3">
          
          
            <p>I&#39;m learning org-mode and I don&#39;t really know what I&#39;m doing, but this is how I&#39;m trying out writing hugo posts with it. I&#39;m used to markdown, so this is a what&#39;s different post. Some minor org-mode tweaks   For some reason when org-mode starts it doesn&#39;t softwrap the paragragh text. I like to have it soft-wrapped so everything is on the screen if it&#39;s not collapsed. Also having some nice indentation makes things visually cleaner, so add this snippet to your ~/.</p>
          
        </div>
        <a href="../../../articles/2019/using_org_mode_in_hugo/" class="btn btn-primary">Read more</a>
      </div>
    
  </div>
</div>


<footer class="footer bg-dark text-light mt-3">
  <div class="container">
    <h2 class="py-5 font-weight-light my-0">Made in Brooklyn, NY.</h2>
  </div>
</footer>
</body>
</html>
